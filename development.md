# blazepose algorithm pipeline

## RECORDER

- Tf-cpn : 复现原来的训练过程（heatmap scale:255）

|            Method             | AP @0.5:0.95 | AP @0.5 | AP @0.75 | AP medium | AP large |
| :---------------------------: | ------------ | ------- | -------- | --------- | -------- |
| **CPN-resnet-50_256_192_ori** | 0.697        | 0.883   | 0.770    | 0.662     | 0.761    |
|   CPN-resnet-50_256x192_400   | 0.702        | 0.904   | 0.782    | 0.677     | 0.746    |
|   CPN-resnet-50_256x192_350   | 0.702        | 0.904   | 0.782    | 0.677     | 0.744    |



- Tf-cpn : 复现原来的训练过程（heatmap scale:1.0）

|            Method             | AP @0.5:0.95 | AP @0.5 | AP @0.75 | AP medium | AP large |
| :---------------------------: | ------------ | ------- | -------- | --------- | -------- |
| **CPN-resnet-50_256_192_ori** | 0.697        | 0.883   | 0.770    | 0.662     | 0.761    |
|   CPN-resnet-50_256x192_400   | 0.606        | 0.853   | 0.669    | 0.581     | 0.644    |
|   CPN-resnet-50_256x192_350   | 0.599        | 0.843   | 0.666    | 0.574     | 0.635    |
|   CPN-resnet-50_256x192_500   | 0.609        | 0.853   | 0.679    | 0.586     | 0.651    |
|   CPN-resnet-50_256x192_600   | 0.613        | 0.854   | 0.680    | 0.588     | 0.653    |
|   CPN-resnet-50_256x192_950   | 0.613        | 0.854   | 0.679    | 0.589     | 0.653    |
|   CPN-resnet-50_256x192_700   | 0.613        | 0.854   | 0.679    | 0.589     | 0.653    |

- [x] 网络没有收敛？继续训练到 500-epoch  :没有提升了

- tf-cpn --> blazepose pipeline.
  - [x] 验证256x256 -->64x64 ，bbox：w==h(scale:255)
  
  | Method                                      | AP @0.5:0.95 | AP @0.5 | AP @0.75 | AP medium | AP large |
  | ------------------------------------------- | ------------ | ------- | -------- | --------- | -------- |
  | CPN-resnet-50_256x256_400(255)              | 0.702        | 0.904   | 0.781    | 0.676     | 0.746    |
  | CPN-resnet-50_256x256_350(255)              | 0.703        | 0.913   | 0.781    | 0.675     | 0.748    |
  | CPN-resnet-50_256x256_400(255,no flip test) | 0.691        | 0.902   | 0.768    | 0.665     | 0.732    |
  | CPN-resnet-50_256x256_350(255,no flip test) | 0.690        | 0.903   | 0.759    | 0.664     | 0.731    |
  |                                             |              |         |          |           |          |
  
  - [ ] 按照blazepose旋转方式对齐
    - [x] No rotation ，没有最后两个关节点
    
    | Method                                       | AP @0.5:0.95 | AP @0.5 | AP @0.75 | AP medium | AP large |
    | -------------------------------------------- | ------------ | ------- | -------- | --------- | -------- |
    | CPN-resnet-50_256x256_400(255,flip test)     | 0.077        | 0.120   | 0.077    | 0.091     | 0.191    |
    | CPN-resnet-50_256x256_350(255，no flip test) | 0.077        | 0.117   | 0.079    | 0.088     | 0.185    |
    | CPN-resnet-50_256x256_200(255,no flip test)  | 0.076        | 0.116   | 0.078    | 0.087     | 0.183    |
    |                                              |              |         |          |           |          |
    
    - [ ] 准确率很低，不应该啊？
    
      - bbox太大了？训练时候global-loss慢慢变为0了，感觉训练样本减少影响很大
    
        - 缩小bbox，继续训练测试结果
        - 不排除invalid样本训练
    
      - 测试的接口有问题？怎么测试一下呢？
    
        - 应该没有问题，指标低是没有过滤gt label造成的
        - 训练样本减少了很多
    
        | Method                                       | AP @0.5:0.95 | AP @0.5 | AP @0.75 | AP medium | AP large |
        | -------------------------------------------- | ------------ | ------- | -------- | --------- | -------- |
        | CPN-resnet-50_256x256_400(255,no flip test)  | 0.131        | 0.202   | 0.133    | 0.175     | 0.321    |
        | CPN-resnet-50_256x256_350(255，no flip test) | 0.131        | 0.202   | 0.134    | 0.175     | 0.319    |
        | CPN-resnet-50_256x256_200(255,no flip test)  | 0.076        | 0.116   | 0.078    | 0.087     | 0.183    |
    
    - [ ] COCO数据集过滤or后处理

